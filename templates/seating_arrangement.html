<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Seating Arrangement</title>
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
        }
        table, th, td {
            border: 1px solid black;
        }
        th, td {
            padding: 8px;
            text-align: left;
        }
    </style>
</head>
<body>
    <h1>Seating Arrangement</h1>

    <label for="classroom-filter">Classroom:</label>
    <select id="classroom-filter">
        <option value="">All</option>
        {% for classroom in classrooms %}
        <option value="{{ classroom.id }}">{{ classroom.hallno }}</option>
        {% endfor %}
    </select>

    <label for="date-filter">Exam Date:</label>
    <input type="date" id="date-filter">

    <button id="filter-button">Filter</button>
    <button onclick="printTable()">Print PDF</button>

    <table id="seating-table">
        <thead>
            <tr>
                <th>Classroom</th>
                <th>Subject</th>
                <th>Exam Date</th>
                <th>Exam Name</th>
                <th>Seat Number</th>
                <th>Exam Time</th>
                <th>Register No</th>
            </tr>
        </thead>
        <tbody id="table-body">
            {% for arrangement in arrangements %}
            <tr data-classroom="{{ arrangement.classroom_number.id }}" data-date="{{ arrangement.exam_date }}">
                <td>{{ arrangement.classroom_number.hallno }}</td>
                <td>{{ arrangement.subject.subjectname }}</td>
                <td>{{ arrangement.exam_date }}</td>
                <td>{{ arrangement.exam_name }}</td>
                <td>{{ arrangement.seat_number }}</td>
                <td>{{ arrangement.exam_time }}</td>
                <td>{{ arrangement.register_no }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <script>
        document.getElementById('filter-button').addEventListener('click', function () {
            const classroomFilter = document.getElementById('classroom-filter').value;
            const dateFilter = document.getElementById('date-filter').value;

            const rows = document.querySelectorAll('#table-body tr');
            rows.forEach(row => {
                const classroomId = row.getAttribute('data-classroom');
                const examDate = row.getAttribute('data-date');

                if ((classroomFilter === '' || classroomFilter === classroomId) &&
                    (dateFilter === '' || dateFilter === examDate)) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            });
        });

        function printTable() {
            const printContent = document.getElementById('seating-table').outerHTML;
            const printWindow = window.open('', '', 'width=800,height=600');
            printWindow.document.write('<html><head><title>Seating Arrangement</title></head><body>');
            printWindow.document.write(printContent);
            printWindow.document.write('</body></html>');
            printWindow.document.close();
            printWindow.print();
        }
    </script>
</body>
</html>
